<?Pub UDT _bookmark _target?><?Pub UDT __target_1 _target?><?Pub UDT registeredtm trademark?><?Pub CX solbook(?><chapter id="clientsetup-1"><?Pub Tag atict:info tracking="on" ref="4"?><?Pub Tag
atict:user user="sk23612" fullname="Juanita Heieck"?><?Pub Tag atict:user
user="jonj" fullname="Juanita Heieck"?><?Pub Tag atict:user user="smorgan"
fullname=""?><?Pub Tag atict:user user="kathys" fullname="Kathy Slattery"?><?Pub Tag
atict:user user="cindys" fullname=""?><?Pub Tag atict:user user="cathleen"
fullname=""?><?Pub Tag atict:user user="eb151805" fullname="Juanita Heieck"?><?Pub Tag
atict:user user="jh118764" fullname="Juanita Heieck"?><?Pub Tag atict:user
user="lh136763" fullname="Laura Hartman"?><?Pub Tag atict:user user="wsm"
fullname=""?><title>Managing Diskless Clients (Tasks)</title><highlights><para>This chapter describes how to manage diskless clients in the Solaris
Operating System (Solaris OS).</para><para>For information on the procedures that are associated with managing
diskless clients, see <olink targetptr="clientsetup-2" remap="internal">Managing Diskless Clients
(Task Map)</olink>. For information about installation problems that are associated
with managing diskless clients, see <olink targetptr="gcfab" remap="internal">Troubleshooting
Diskless Client Installation Problems</olink>. For overview information on
managing diskless clients, see <olink targetptr="clientconcept-15236" remap="internal">Chapter&nbsp;6,
Managing Client-Server Support (Overview)</olink>.</para>
</highlights><sect1 id="clientsetup-2"><title>Managing Diskless Clients (Task Map)</title><para>The following table identifies the procedures that are required to manage
diskless clients.</para><informaltable frame="all"><tgroup cols="3" colsep="1" rowsep="1"><colspec colname="colspec6" colwidth="33*"/><colspec colname="colspec7" colwidth="33*"/><colspec colname="colspec8" colwidth="33*"/><thead><row><entry><para>Task</para>
</entry><entry><para>Description</para>
</entry><entry><para>For Instructions</para>
</entry>
</row>
</thead><tbody><row><entry><para>1. (Optional) Enable Solaris Management Console logging to view diskless
client error messages.</para>
</entry><entry><para>Choose Log Viewer from the console main window to view diskless client
error messages.</para>
</entry><entry><para><olink targetptr="smcover-18" remap="internal">Starting the Solaris Management Console</olink></para>
</entry>
</row><row><entry><para></para><para>2. Prepare for adding a diskless client.</para>
</entry><entry><para>Verify supported releases and identify the platform, media path, and
cluster (or software group) of each diskless client.</para>
</entry><entry><para><olink targetptr="fwaol" remap="internal">How to Prepare for Adding
Diskless Clients in a GRUB Based Boot Environment</olink></para><para><olink targetptr="clientsetup-7" remap="internal">How to Prepare for Adding Diskless
Clients in the Solaris 10 OS</olink></para>
</entry>
</row><row><entry><para>3. Add required OS services to an OS server.</para>
</entry><entry><para>Add the OS services for the diskless clients you want to support by
using the <command>smosservice</command> command. You must identify the platform,
media path, and each diskless client platform that you want to support.</para>
</entry><entry><para><olink targetptr="clientsetup-20" remap="internal">How to Add OS Services for Diskless
Client Support</olink></para>
</entry>
</row><row><entry><para>4. Locate and install any <literal>ARCH=all</literal> packages that
were missed when you added OS services to the server.</para><note><para>To avoid having to add these packages to each diskless client
individually, perform this task <emphasis>prior</emphasis> to adding diskless
client support .</para>
</note>
</entry><entry><para>The <command>smosservice add</command> command does not install any
root (<filename>/</filename>) or <filename>/usr</filename> packages that are
designated <literal>ARCH=all</literal>. These packages must be installed manually
after adding the OS services to the OS server.</para><para>This behavior has existed since the Solaris 2.1 OS. The behavior applies
to both SPARC based and x86 based platforms. Missing <literal>ARCH=all</literal> packages
vary, depending on which Solaris OS you are running.</para>
</entry><entry><para><olink targetptr="archall-1" remap="internal">How to Locate and Install Missing ARCH=all
Packages</olink></para>
</entry>
</row><row><entry><para>5. Add a diskless client.</para>
</entry><entry><para>Add diskless client support by specifying all required information by
using the <command>smdiskless</command> command.</para>
</entry><entry><para><olink targetptr="clientsetup-4" remap="internal">How to Add a Diskless Client
in the GRUB Based Boot Environment</olink></para><para><olink targetptr="fxcpp" remap="internal">How to Add a Diskless Client in the Solaris
10 OS</olink></para>
</entry>
</row><row><entry><para>6. Boot the diskless client.</para>
</entry><entry><para>Verify that a diskless client was successfully added by booting the
diskless client.</para>
</entry><entry><para><olink targetptr="fwazk" remap="internal">How to Boot a Diskless Client With
GRUB</olink></para><para><olink targetptr="clientsetup-5" remap="internal">How to Boot a Diskless Client in the
Solaris 10 OS</olink></para>
</entry>
</row><row><entry><para>7. (Optional) Delete diskless client support.</para>
</entry><entry><para>Delete support for a diskless client if it is no longer required.</para>
</entry><entry><para><olink targetptr="clientsetup-11" remap="internal">How to Remove Diskless Client Support</olink></para>
</entry>
</row><row><entry><para>8. (Optional) Delete OS services for a diskless client.</para>
</entry><entry><para>Delete OS services for a diskless client if they are no longer needed.</para>
</entry><entry><para><olink targetptr="clientsetup-10" remap="internal">How to Remove OS Services for Diskless
Clients</olink></para>
</entry>
</row><row><entry><para>9. (Optional) Patch OS services.</para>
</entry><entry><para>Add, delete, list, or synchronize patches for diskless client OS services.</para>
</entry><entry><para><olink targetptr="clientsetup-26" remap="internal">How to Add an OS Patch for a Diskless
Client</olink></para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable>
</sect1><sect1 id="clientsetup-3"><title>Preparing for Managing Diskless Clients</title><para>These sections describe the preparations that are necessary for managing
diskless clients.</para><itemizedlist><para>Keep the following key points in mind when managing diskless clients:</para><listitem><para>The Solaris installation program doesn't prompt you to set
up diskless client support. You must manually create an <filename>/export</filename> partition
to support diskless clients. You create the <filename>/export</filename> partition
during or after the installation process.</para>
</listitem><listitem><para>The <filename>/export</filename> partition must contain a
minimum of 5 Gbytes, depending upon the number of clients supported. For specific
information, see .</para>
</listitem><listitem><para>The name service identified in the <command>smosservice</command> or <command>smdiskless</command> commands must match the primary name service identified
in the <filename>/etc/nsswitch.conf</filename> file. If you don't specify
a name service in the <command>smdiskless</command> or <command>smosservice</command> commands,
the default name service is <literal>files</literal>.</para><para>Use the <option>D</option> option to the <command>smosservice</command> and <command>smdiskless</command> commands
to specify a name server. For more information, see the <olink targetdoc="refman" targetptr="smosservice-1m" remap="external"><citerefentry><refentrytitle>smosservice</refentrytitle><manvolnum>1M</manvolnum></citerefentry></olink> and <olink targetdoc="refman" targetptr="smdiskless-1m" remap="external"><citerefentry><refentrytitle>smdiskless</refentrytitle><manvolnum>1M</manvolnum></citerefentry></olink> man pages.</para><para><emphasis role="strong">Starting with the Solaris 10 8/07 release</emphasis>,
the <command>set_nfs4_domain</command> script that was delivered in the Solaris
10 OS is no longer used to set the NFSv4 domain. To set the NFSv4 domain,
add the <literal>nfs4_domain</literal> keyword to the diskless client's <command>sysidcfg</command> file, for example, <filename>server:/export/root/client/etc/sysidcfg</filename>.</para><para>If the <literal>nfs4_domain</literal> keyword exists in the client system's <command>sysidcfg</command> file, the first boot of a diskless client sets the domain
accordingly. Also, the OS server should be up and running, and the diskless
client's NFSv4 domain setting must match the setting in the OS server's <filename>/var/run/nfs4_domain</filename> file.</para><para>For more information, see <olink targetdoc="solinstallnet" targetptr="preconsysid-55534" remap="external"><citetitle remap="section">Preconfiguring With the sysidcfg File</citetitle> in <citetitle remap="book">Solaris Express Installation Guide: Network-Based Installations</citetitle></olink>.</para>
</listitem><listitem><para>The OS server and the diskless client must be on the same
subnet.</para>
</listitem><listitem><para>You cannot provide client services on a multiterabyte UFS
file system, because OS and diskless client services <emphasis>cannot</emphasis> be
added to a UFS file system that resides on an EFI-labeled disk.</para><note><para>Attempts to add OS and diskless client services to a UFS file
system that resides on an EFI-labeled disk result in an erroneous insufficient
disk space message similar to the following:</para><screen>The partition /export does not have enough free space.
1897816 KB (1853.34 MB) additional free space required.
Insufficient space available on
/dev/dsk/c0t5d0s0 /export</screen>
</note>
</listitem>
</itemizedlist><para>After you determine the platform, media path, and cluster for each diskless
client, you are ready to add OS services. </para><itemizedlist><para>The following directories are created and populated for each OS service
that you add:</para><listitem><para><?Pub _nolinebreak?><filename>/export/Solaris_<replaceable>version</replaceable>/Solaris_<replaceable>version</replaceable>-<replaceable>instruction-set</replaceable>.all</filename><?Pub /_nolinebreak?> (symbolic link to <filename>/export/exec/Solaris_<replaceable>version</replaceable>/Solaris_<replaceable>version</replaceable>-<replaceable>instruction-set</replaceable>.all</filename>)</para>
</listitem><listitem><para><filename>/export/Solaris_<replaceable>version</replaceable></filename></para>
</listitem><listitem><para><filename>/export/Solaris_<replaceable>version</replaceable>/var</filename></para>
</listitem><listitem><para><filename>/export/Solaris_<replaceable>version</replaceable>/opt</filename></para>
</listitem><listitem><para><filename>/export/share</filename></para>
</listitem><listitem><para><filename>/export/root/templates/Solaris_<replaceable>version</replaceable></filename></para>
</listitem><listitem><para><filename>/export/root/clone</filename></para>
</listitem><listitem><para><filename>/export/root/clone/Solaris_<replaceable>version</replaceable></filename></para>
</listitem><listitem><para><filename>/export/root/clone/Solaris_<replaceable>version</replaceable>/<replaceable>machine-class</replaceable></filename></para>
</listitem>
</itemizedlist><itemizedlist><para>The following default directories are created and populated on the OS
server for each diskless client that you add:</para><listitem><para><filename>/export/root/<replaceable>diskless-client</replaceable></filename></para>
</listitem><listitem><para><filename>/export/swap/<replaceable>diskless-client</replaceable></filename></para>
</listitem><listitem><para><filename>/tftpboot/<replaceable>diskless-client-ipaddress-in-hex</replaceable></filename><filename>/export/dump/<replaceable>diskless-client</replaceable></filename> (if
you specify the <option>x</option> <replaceable>dump</replaceable> option)</para>
</listitem>
</itemizedlist><note><para>You can modify the default locations of the root (<filename>/</filename>), <?Pub
_nolinebreak?><filename>/swap</filename><?Pub /_nolinebreak?>, and <?Pub _nolinebreak?><filename>/dump</filename><?Pub /_nolinebreak?> directories by using the <option>x</option> option
to the <command>smosservice</command> and <command>smdiskless</command> commands.
However, do not create these directories under the <filename>/export</filename> file
system.</para>
</note><task id="fwaol" arch="x86"><title>How to
Prepare for Adding Diskless Clients in a GRUB Based Boot Environment</title><tasksummary><para>Use this procedure to prepare for adding a diskless client. This procedure
includes general information for x86 based systems.</para><para>When you use the <command>smosservice add</command> command to add OS
services, you must specify the platform, media path, and cluster (or software
group) of each diskless client platform that you want to support.</para>
</tasksummary><taskprerequisites><para>Ensure that the system that is intended to be the OS service is running
a supported release. Also, verify that the OS server release and diskless
client release combination is supported. For more information, see <olink targetptr="clientconcept-28" remap="internal">OS Server and Diskless Client Support Information</olink>.</para>
</taskprerequisites><procedure><step><para>Identify the diskless client platform by using this format:</para><para><replaceable>instruction-set</replaceable>.<replaceable>machine-class</replaceable>.<replaceable>Solaris-version</replaceable></para><para>For example:</para><para><literal>i386.i86pc.Solaris_11</literal></para><para>The following are the possible platform options:</para><informaltable frame="topbot"><tgroup cols="3" colsep="0" rowsep="0"><?PubTbl tgroup dispwid="5.26in"?><colspec colname="colspec6" colwidth="27.49*"/><colspec colname="colspec7" colwidth="28.75*"/><colspec colname="colspec8" colwidth="43.77*"/><thead><row><entry rowsep="1"><para>Instruction Set</para>
</entry><entry rowsep="1"><para>Machine Class</para>
</entry><entry rowsep="1"><para>Solaris Version</para>
</entry>
</row>
</thead><tbody><row><entry><para>sparc</para>
</entry><entry><para>sun4v</para><para>sun4u, sun4m, sun4d, and sun4c</para>
</entry><entry><para>Starting with the Solaris 10 1/06 OS</para><para>Solaris Express, Solaris 10, Solaris 9, and Solaris 8</para>
</entry>
</row><row><entry><para>i386</para>
</entry><entry><para>i86pc</para>
</entry><entry><para>Solaris Express, Solaris 10, Solaris 9, and Solaris 8</para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable><note><para>The sun-4c architecture is not supported in the Solaris 8, Solaris
9, Solaris 10, or Solaris
Express releases. The sun-4d architecture is not supported in the Solaris
9, Solaris 10, or Solaris Express releases. The sun-4m architecture
is not supported in the Solaris Express Developer Editionor
the Solaris 10 release.</para>
</note>
</step><step id="fwaex"><para>Identify the media path.</para><para>The media path
is the full path to the disk image that contains the OS that you want to install
for the diskless client.</para><para>The Solaris OS is delivered on multiple CDs. However, you cannot use
the <command>smosservice</command> command to load OS services from a multiple
CD distribution. You must run the scripts that are found on the Solaris software
CDs (and optional Language CD) to do the following:</para>
</step><step><para>Create an install image on a server. For information on setting
up an install server, refer to <olink targetdoc="solinstallnet" remap="external"><citetitle remap="book">Solaris Express Installation Guide: Network-Based Installations</citetitle></olink>.</para>
</step><step><para>Load the required OS services from the CD image.</para><itemizedlist><para>Use one of the following scripts:</para><listitem><para>CD 1 &ndash; <filename>/media/Solaris_11/Tools/setup_install_server</filename></para>
</listitem><listitem><para>Additional Solaris Software CDs &ndash; <filename>/media/Solaris_11/Tools/add_to_install_server</filename></para>
</listitem><listitem><para>Language CD &ndash; <filename>/media/Solaris_11/Tools/add_to_install_server</filename></para>
</listitem>
</itemizedlist><para>For example, if you are using the <command>setup_install_server</command> script
from the Solaris Express Software 1 CD on
a locally connected CD-ROM device, the syntax looks similar to the following:</para><screen># <userinput>mkdir /export/install/sol_11_x86</userinput>
# <userinput>cd /cd_mount_point/Solaris_11/Tools</userinput>
# <userinput>./setup_install_server /export/install/sol_11_x86</userinput></screen>
</step><step><para>Add the <literal>BootFile</literal> and <literal>BootSrvA</literal> DHCP
options to your DHCP server configuration to enable a PXE boot.</para><para>For
example:</para><screen>Boot server IP (BootSrvA) : <replaceable>svr-addr</replaceable>
(BootFile) : 01<replaceable>client-macro</replaceable></screen><para>where <replaceable>svr-addr</replaceable> is the IP address of the OS
server and <replaceable>client-macro</replaceable> is named by the client's
Ethernet type (01) and the mac address of the client. This number is also
the name of the file that is used in the <filename>/tftpboot</filename> directory
on the installation server.</para><note><para>The notation for the <replaceable>client-macro</replaceable> consists
of uppercase letters. This notation should not contain any colons.</para>
</note><para>You can add these options from the command-line, or by using DHCP Manager.
See <olink targetptr="gcbpt" remap="internal">Example&nbsp;7&ndash;4</olink> for more information.</para><para>For more information, see <olink targetptr="fvzpk" remap="internal">How to Perform a
GRUB Based Boot From the Network</olink>, <olink targetdoc="solinstallnet" targetptr="dhcp-admin-38" remap="external"><citetitle remap="section">Preconfiguring System Configuration Information With the DHCP Service (Tasks)</citetitle> in <citetitle remap="book">Solaris Express Installation Guide: Network-Based Installations</citetitle></olink>,
and <olink targetdoc="sysadv3" targetptr="dhcptm-1" remap="external">Part&nbsp;II, <citetitle remap="chapter">DHCP,</citetitle> in <citetitle remap="book">System Administration Guide: IP Services</citetitle></olink>.</para>
</step><step><para>After the Solaris CD image is installed on the disk, note the
disk media path. For example:</para><screen>/net/export/install/sol_11_x86_</screen><para>This is the disk media path that needs to be specified when you use
the <command>smosservice</command> command.</para>
</step><step id="fwagu"><para>Identify the <filename>SUNWCXall</filename> cluster
when you add OS services.</para><para>You must use the same cluster for diskless
clients that run the same OS on the same system. </para><note><para>Always specify <filename>SUNWCXall</filename> as the cluster.</para>
</note>
</step>
</procedure>
</task><task id="clientsetup-7"><title>How to Prepare for Adding Diskless Clients
in the Solaris 10 OS</title><tasksummary><para>When you use the <command>smosservice add</command> command to add OS
services, you must specify the platform, media path, and cluster (or software
group) of each diskless client platform that you want to support.</para>
</tasksummary><taskprerequisites><para>Ensure that the system that is intended to be the OS service is running
a supported release. Also verify that the combination of OS server release
and diskless client release is supported. For more information, see <olink targetptr="clientconcept-28" remap="internal">OS Server and Diskless Client Support Information</olink>.</para>
</taskprerequisites><procedure><step><para>Identify the diskless client platform by using this format:</para><para><replaceable>instruction-set</replaceable>.<replaceable>machine-class</replaceable>.Solaris-<replaceable>version</replaceable></para><para>For example:</para><para><literal>sparc.sun4u.Solaris_10</literal></para><para>The following are the possible platform options:</para><informaltable frame="topbot"><tgroup cols="3" colsep="0" rowsep="0"><?PubTbl tgroup dispwid="5.26in"?><colspec colname="colspec6" colwidth="27.49*"/><colspec colname="colspec7" colwidth="28.75*"/><colspec colname="colspec8" colwidth="43.77*"/><thead><row><entry rowsep="1"><para><replaceable>instruction-set</replaceable></para>
</entry><entry rowsep="1"><para><replaceable>machine-class</replaceable></para>
</entry><entry rowsep="1"><para>Solaris_<replaceable>version</replaceable></para>
</entry>
</row>
</thead><tbody><row><entry><para>sparc</para>
</entry><entry><para>sun4v</para><para>sun4c, sun4d, sun4m, sun4u,</para>
</entry><entry><para>Starting with the Solaris 10 1/06 OS</para><para> Solaris_10, Solaris_9, and Solaris_8</para>
</entry>
</row><row><entry><para>i386</para>
</entry><entry><para>i86pc</para>
</entry><entry><para>Solaris_10, Solaris_9, and Solaris_8</para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable><note><para>The sun-4c architecture is not supported in the Solaris 8, Solaris
9, or Solaris 10 releases. The sun-4d architecture is not supported in the
Solaris 9 or 10 releases. The sun-4m architecture is not supported in the
Solaris 10 release.</para>
</note>
</step><step id="clientsetup-step-22"><para>Identify the media path.</para><para>The
media path is the full path to the disk image that contains the OS that you
want to install for the diskless client.</para><para>The Solaris OS is delivered on multiple CDs. However, you cannot use
the <command>smosservice</command> command to load OS services from a multiple
CD distribution. You must run the scripts that are found on the Solaris software
CDs (and optional Language CD) to do the following:</para>
</step><step><para>Create an install image on a server. For information on setting
up an install server, refer to <olink targetdoc="solinstallnet" remap="external"><citetitle remap="book">Solaris Express Installation Guide: Network-Based Installations</citetitle></olink>.</para>
</step><step><para>Load the required OS services from the CD image.</para><itemizedlist><para>Use one of the following scripts:</para><listitem><para>CD 1 &ndash; <filename>/media/Solaris_11/Tools/setup_install_server</filename></para>
</listitem><listitem><para>Additional Solaris Software CDs &ndash; <filename>/media/Solaris_11/Tools/add_to_install_server</filename></para>
</listitem><listitem><para>Language CD &ndash; <filename>/media/Solaris_11/Tools/add_to_install_server</filename></para>
</listitem>
</itemizedlist><para>For example, if you are using the <command>setup_install_server</command> script
from the Solaris Express Community Edition  Software
1 CD on a locally connected CD-ROM device, the syntax looks similar to the
following:</para><screen># <userinput>mkdir /export/install/sparc_11</userinput>
# <userinput>cd /cd_mount_point/Solaris_11/Tools</userinput>
# <userinput>./setup_install_server /export/install/sparc_11</userinput></screen>
</step><step><para>After the Solaris CD image is installed on the disk, specify the
disk media path. For example:</para><screen>/export/install/sparc_11</screen>
</step><step id="clientsetup-step-23"><para>Identify the <filename>SUNWCXall</filename> cluster
when you add OS services.</para><para>You must use the same cluster for diskless
clients that run the same OS on the same system. </para><itemizedlist><para>For example, consider the following Solaris 9 diskless clients:</para><listitem><para><filename>sparc.sun4m.Solaris_9</filename></para>
</listitem><listitem><para><filename>sparc.sun4u.Solaris_9</filename></para>
</listitem>
</itemizedlist><para>To set up these diskless clients, you would need to specify the <literal>SUNWCXall</literal> cluster for each diskless client because the <literal>sun4u</literal> and <literal>sun4m</literal> systems require the <filename>SUNWCXall</filename> cluster.
In addition, diskless clients that run the same operating release (in this
example, Solaris_9) on the same system must use the same cluster.</para><note><para>If you are using a <filename>sun4u</filename> system, or if you
are using a system with an accelerated 8-bit color memory frame buffer (<literal>cgsix</literal>), you <emphasis>must</emphasis> specify <filename>SUNWCXall</filename> as
the cluster. </para>
</note>
</step>
</procedure>
</task><task id="clientsetup-20"><title>How to Add OS Services for Diskless Client
Support</title><tasksummary><para>Use this procedure to add OS services for a diskless client on the server.</para><note><para>When adding OS services with the <command>smosservice add</command> command,
root (<filename>/</filename>) and <filename>/usr</filename> packages with
the <literal>ARCH=all</literal> type are not installed. These packages are
skipped. No warning or error messages are displayed. After you add the OS
services to the OS server, you must install the missing packages manually.
For instructions, see <olink type="custom-text" targetptr="archall-1" remap="internal">How
to Locate and Install Missing <literal>ARCH=all</literal> Packages</olink>.</para>
</note>
</tasksummary><procedure>&rolestep.sgm;<step id="clientsetup-step-7"><para>Verify that the Solaris Management Console
server is running and that the diskless client tools are available on the
system.</para><screen># <userinput>/usr/sadm/bin/smosservice list -H <replaceable>host-name</replaceable>:898 --</userinput></screen>
</step><step id="diskless-step-1"><para><indexterm><primary>adding</primary><secondary>diskless client OS services (how to)</secondary></indexterm><indexterm><primary>diskless clients </primary><secondary>adding OS services for (how to)</secondary></indexterm>Add the OS services.</para><screen># <userinput>/usr/sadm/bin/smosservice add -H</userinput> <replaceable>host-name</replaceable><userinput>:898</userinput> <userinput>-- -o</userinput> <replaceable>host-name</replaceable> 
<userinput>-x mediapath=</userinput><replaceable>path</replaceable> <userinput>-x platform=</userinput><replaceable>instruction-set</replaceable>.<replaceable>machine-class</replaceable>.Solaris_<replaceable>version</replaceable> 
<userinput>-x cluster=</userinput><replaceable>cluster-name</replaceable> <userinput>-x locale=</userinput><replaceable>locale-name</replaceable></screen><variablelist><varlistentry><term><command>add</command></term><listitem><para>Adds the specified OS service.</para>
</listitem>
</varlistentry><varlistentry><term><option>H</option> <replaceable>host-name</replaceable>:898</term><listitem><para>Specifies the host name and port to which you want to connect.
If you do not specify a port, the system connects to the default port, 898.</para><note><para>The <option>H</option> option is not a required option when using
the <command>smossservice</command> command to add OS services.</para>
</note>
</listitem>
</varlistentry><varlistentry><term><command>--</command></term><listitem><para>Identifies that the subcommand arguments start after this
point.</para>
</listitem>
</varlistentry><varlistentry><term><option>x</option> <replaceable>mediapath=path</replaceable></term><listitem><para>Specifies the full path to the Solaris image.</para>
</listitem>
</varlistentry><varlistentry><term><option>x</option>  <replaceable>platform=instruction-set.machine-class.</replaceable>.Solaris_<replaceable>version</replaceable></term><listitem><para>Specifies the instruction architecture, machine class, and
the Solaris version to be added. </para>
</listitem>
</varlistentry><varlistentry><term><option>x</option>  <replaceable>cluster=cluster-name</replaceable></term><listitem><para>Specifies the Solaris cluster to  install.</para>
</listitem>
</varlistentry><varlistentry><term><option>x</option>  <replaceable>locale=locale-name</replaceable></term><listitem><para>Specifies the locale to install.</para>
</listitem>
</varlistentry>
</variablelist><note><para>The installation process can take about 45 minutes, depending
on the server speed and the OS service configuration you choose.</para>
</note><para>For more information, see the <olink targetdoc="refman" targetptr="smosservice-1m" remap="external"><citerefentry><refentrytitle>smosservice</refentrytitle><manvolnum>1M</manvolnum></citerefentry></olink> man page.</para>
</step><step id="clientsetup-step-10"><para>(Optional) Continue to add the other
OS services.</para>
</step><step id="diskless-step-2"><para>When you are finished adding OS services,
verify that the OS services were installed. </para><screen># <userinput>/usr/sadm/bin/smosservice list -H <replaceable>host-name</replaceable>:898 --</userinput></screen>
</step>
</procedure><example arch="sparc"><title>Adding an OS Service for Diskless Client Support</title><para>This example shows how to add Solaris 10 SPARC based OS services on
the server <literal>jupiter</literal>. The server <literal>jupiter</literal> is
running the Solaris 10 release. The CD image of the Solaris 10 SPARC based
OS is located on the installation server, <literal>myway</literal>, in <filename>/export/s10/combined.s10s_u2wos/61</filename>.</para><screen># <userinput>/usr/sadm/bin/smosservice add -H jupiter:898 -- -o jupiter 
-x mediapath=/net/myway/export/s10/combined.s10s_u2wos/61
-x platform=sparc.sun4u.Solaris_10 
-x cluster=SUNWCXall -x locale=en_US</userinput>

# <userinput>/usr/sadm/bin/smosservice list - H jupiter:898</userinput>
Authenticating as user: root

Type /? for help, pressing enter accepts the default denoted by [ ]
Please enter a string value for: password :: <replaceable>xxxxxx</replaceable>
Loading Tool: com.sun.admin.osservermgr.cli.OsServerMgrCli
from jupiter:898
Login to jupiter as user root was successful.
Download of com.sun.admin.osservermgr.cli.OsServerMgrCli from jupiter:898 
was successful.</screen>
</example><example id="gcfan" arch="x86"><title>Adding an OS Service for Diskless Client Support</title><para>This example shows how to add Solaris 10 x86 based OS services on the
server <literal>orbit</literal>. The server <literal>orbit</literal> is running
the Solaris 10 release. The CD image of the Solaris 10 x86 based OS is located
on the installation server, <literal>seriously</literal>, in <filename>/export/s10/combined.s10x_u2wos/03</filename>.</para><screen># <userinput>/usr/sadm/bin/smosservice add -H orbit:898 -- -o orbit -x
mediapath=/net/seriously/export/s10u2/combined.s10x_u2wos/03 -x
platform=i386.i86pc.Solaris_10 -x cluster=SUNWCXall -x locale=en_US</userinput>

# <userinput>/usr/sadm/bin/smosservice list - H orbit:898</userinput>
Type /? for help, pressing &lt;enter&gt; accepts the default denoted by [ ]
Please enter a string value for: password ::
Starting Solaris Management Console server version 2.1.0.
endpoint created: :898
Solaris Management Console server is ready.
Loading Tool: com.sun.admin.osservermgr.cli.OsServerMgrCli from orbit:898
Login to orbit as user root was successful.
Download of com.sun.admin.osservermgr.cli.OsServerMgrCli from orbit:898 was successful.
Client       	Root Area
                Swap Area
                Dump Area
--------------------------------------------------------------------------------
.
.
.
#</screen>
</example><taskrelated role="additional-action"><para>Locate and install any <literal>ARCH=all</literal> packages that were
missed when you ran the <command>smosservice add</command> command to add
the OS services to the OS server. For more information, see <olink type="custom-text" targetptr="archall-1" remap="internal">How to Locate and Install Missing <literal>ARCH=all</literal> Packages</olink>.</para>
</taskrelated>
</task><task id="clientsetup-4" arch="x86"><title>How to Add a Diskless Client in
the GRUB Based Boot Environment</title><tasksummary><para>Starting with the Solaris
10 1/06 release, use this procedure to add a diskless client after you have
added OS services.</para>
</tasksummary><procedure>&rolestep.sgm;<step id="fxjjl"><para>Add the diskless client.</para><screen width="100"># <userinput>/usr/sadm/bin/smdiskless add -- -i</userinput> <replaceable>ip-address</replaceable> <userinput>-e</userinput> <replaceable>ethernet-address</replaceable> 
<userinput>-n</userinput> <replaceable>client-name</replaceable> <userinput>-x os=</userinput><replaceable>instruction-set.machine-class</replaceable>.Solaris_<replaceable>version</replaceable> 
<userinput>-x root=/export/root/</userinput><replaceable>client-name</replaceable> <userinput>-x swap=/export/swap/</userinput><replaceable>client-name</replaceable> 
<userinput>-x swapsize=</userinput><replaceable>size</replaceable> <userinput>-x tz=</userinput><replaceable>time-zone</replaceable> <userinput>-x locale=</userinput><replaceable>locale-name</replaceable></screen><variablelist><varlistentry><term><command>add</command></term><listitem><para>Adds the specified diskless client.</para>
</listitem>
</varlistentry><varlistentry><term><command>--</command></term><listitem><para>Identifies that the subcommand arguments start after this
point.</para>
</listitem>
</varlistentry><varlistentry><term><option>i</option> <replaceable>ip-address</replaceable></term><listitem><para>Identifies the IP address of the diskless client.</para>
</listitem>
</varlistentry><varlistentry><term><option>e</option> <replaceable>ethernet-address</replaceable></term><listitem><para>Identifies the Ethernet address of the diskless client.</para>
</listitem>
</varlistentry><varlistentry><term><option>n</option> <replaceable>client-name</replaceable></term><listitem><para>Specifies the name of the diskless client.</para>
</listitem>
</varlistentry><varlistentry><term><option>x os=</option><replaceable>instruction-set.machine-class</replaceable>.Solaris_<replaceable>version</replaceable></term><listitem><para>Specifies the instruction architecture, machine class, OS,
and the Solaris version for the diskless client.</para>
</listitem>
</varlistentry><varlistentry><term><option>x root=</option><command>root=/export/root/</command><replaceable>client-name</replaceable></term><listitem><para>Identifies the root (<filename>/</filename>) directory for
the diskless client.</para>
</listitem>
</varlistentry><varlistentry><term><option>x swap=</option><command>root=/export/root/</command><replaceable>client-name</replaceable></term><listitem><para>Identifies the swap file for the diskless client.</para>
</listitem>
</varlistentry><varlistentry><term><option>x swapsize=</option><replaceable>size</replaceable></term><listitem><para>Specifies the size of the swap file in Mbytes. The default
is 24 Mbytes.</para>
</listitem>
</varlistentry><varlistentry><term><option>x tz=</option><replaceable>time-zone</replaceable></term><listitem><para>Specifies the time-zone for the diskless client.</para>
</listitem>
</varlistentry><varlistentry><term><option>x locale=</option><replaceable>locale-name</replaceable></term><listitem><para>Specifies the locale to install for the diskless client.</para>
</listitem>
</varlistentry>
</variablelist><para>For more information, see the <olink targetdoc="refman" targetptr="smdiskless-1m" remap="external"><citerefentry><refentrytitle>smdiskless</refentrytitle><manvolnum>1M</manvolnum></citerefentry></olink> man page.</para>
</step><step><para>If not already created, add the <literal>BootSrva</literal> and <literal>BootFile</literal> DHCP options to your DHCP server configuration to enable
a PXE boot.</para><para>For example:</para><screen>Boot server IP (BootSrvA) : <replaceable>svr-addr</replaceable> 
Boot file (BootFile) : 01<replaceable>client-macro</replaceable></screen><para>where <replaceable>svr-addr</replaceable> is the IP address of the server
and <replaceable>client-macro</replaceable> is named by the client's Ethernet
type (01) and the mac address of the client. This number is also the name
of the file that is used in the <filename>/tftpboot</filename> directory on
the installation server.</para><note><para>The <replaceable>client-macro</replaceable> notation consists
of uppercase letters. The notation should not contain any colons.</para>
</note><para>The following files and directories are created in the <filename>/tftpboot</filename> directory:</para><screen>drwxr-xr-x   6 root sys     512 Dec 28 14:53 <replaceable>client-host-name</replaceable>
lrwxrwxrwx   1 root root     31 Dec 28 14:53 menu.lst.01<replaceable>ethernet-address</replaceable>
						-&gt; /tftpboot/<replaceable>client-host-name</replaceable>/grub/menu.lst
-rw-r--r--   1 root root 118672 Dec 28 14:53 01<replaceable>ethernet-address</replaceable></screen>
</step><step><para>If the console is on a serial port, edit the <filename>/tftpboot/menu.lst.01</filename><replaceable>ethernet-address</replaceable> file. Uncomment the
line that specifies the <literal>tty</literal> setting.</para><para>To change
the default <filename>menu.lst</filename> file that is created on the client,
edit the <literal>echo</literal> lines in the <filename>/usr/sadm/lib/wbem/config_tftp</filename> file.</para><para>For more information, see <olink targetptr="fvzok" remap="internal">Booting an x86 Based
System from the Network</olink>.</para>
</step><step id="gbwuj"><para>Verify that the diskless clients were installed. </para><screen># <userinput>/usr/sadm/bin/smdiskless list -H <replaceable>host-name</replaceable>:898 --</userinput></screen>
</step><step id="fxjdz"><para>(Optional) Continue to use the <command>smdiskless
add</command> command to add each diskless client.</para>
</step>
</procedure><example id="fxjjt" arch="x86"><title>Adding Diskless Client Support to an x86 Based System in the GRUB Boot
Environment</title><para>This example shows how to add a Solaris 10 x86 based diskless client, <literal>mikey1</literal>.</para><screen>rainy-01# <userinput>/usr/sadm/bin/smdiskless add -H sdts-01-qfe0 -- -o sdts-01-qfe0
-n mikey1 -i 192.168.20.22 -e 00:E0:88:55:33:BC -x os=i386.i86pc.Solaris_10
-x root=/export/root/mikey1 -x swap=/export/swap/mikey1</userinput>
Loading Tool: com.sun.admin.osservermgr.cli.OsServerMgrCli
from  sdts-01-qfe0
Login to rainy-01-qfe0 as user root was successful.
Download of com.sun.admin.osservermgr.cli.OsServerMgrCli from
rainy-01-qfe0 was successful.

# <userinput>/usr/sadm/bin/smdiskless list -H mikey1:898 --</userinput>
Loading Tool: com.sun.admin.osservermgr.cli.OsServerMgrCli from mikey1:898
Login to mikey1 as user root was successful.
Download of com.sun.admin.osservermgr.cli.OsServerMgrCli from mikey1:898 was 
successful.
Platform
--------------------------------------------------------------------------------
i386.i86pc.Solaris_10                                                           
sparc.sun4us.Solaris_10                                                         
sparc.sun4u.Solaris_10                                                          
i386.i86pc.Solaris_9                                                            </screen>
</example><example id="gcbpt" arch="x86"><title>Adding the <literal>BootSrvA</literal> and <literal>BootFile</literal> DHCP
Options to the DHCP Server Configuration</title><para>This example shows how to add the <literal>BootSrva</literal> and <literal>BootFile</literal> DHCP options that are necessary for enabling a PXE boot.</para><screen width="100">rainy-01# <userinput>pntadm -A mikey1 -m  0100E0885533BC -f 'MANUAL+PERMANENT' \
-i 0100E0885533BC 192.168.0.101</userinput></screen><screen>rainy-01# <userinput>dhtadm  -A -m 0100E0885533BC -d \
":BootSrvA=192.168.0.1:BootFile=0100E0885533BC:"</userinput></screen><para>In the preceding examples, the server address is the IP address of the
server, and the client macro is named by the client's Ethernet type (01) and
its mac address. This number is also the name of the file that is used in
the <filename>/tftpboot</filename> directory on the installation server. Note
that the notation for the client macro consists of uppercase letters and should
not contain any colons.</para>
</example>
</task><task id="fxcpp"><title>How to Add a Diskless Client in the Solaris 10 OS</title><tasksummary><para>Use this procedure to add a diskless client after you have added OS
services. Unless otherwise noted, this procedure includes general information
for both SPARC based and x86 based systems.</para>
</tasksummary><procedure>&rolestep.sgm;<step id="fxchq"><para>Add the diskless client.</para><screen width="100"># <userinput>/usr/sadm/bin/smdiskless add -- -i</userinput> <replaceable>ip-address</replaceable> <userinput>-e</userinput> <replaceable>ethernet-address</replaceable> 
<userinput>-n</userinput> <replaceable>client-name</replaceable> <userinput>-x os=</userinput><replaceable>instruction-set.machine-class</replaceable>.Solaris_<replaceable>version</replaceable> 
<userinput>-x root=/export/root/</userinput><replaceable>client-name</replaceable> <userinput>-x swap=/export/swap/</userinput><replaceable>client-name</replaceable> 
<userinput>-x swapsize=</userinput><replaceable>size</replaceable> <userinput>-x tz=</userinput><replaceable>time-zone</replaceable> <userinput>-x locale=</userinput><replaceable>locale-name</replaceable></screen><variablelist><varlistentry><term><command>add</command></term><listitem><para>Adds the specified diskless client.</para>
</listitem>
</varlistentry><varlistentry><term><command>--</command></term><listitem><para>Identifies that the subcommand arguments start after this
point.</para>
</listitem>
</varlistentry><varlistentry><term><option>i</option> <replaceable>ip-address</replaceable></term><listitem><para>Identifies the IP address of the diskless client.</para>
</listitem>
</varlistentry><varlistentry><term><option>e</option> <replaceable>ethernet-address</replaceable></term><listitem><para>Identifies the Ethernet address of the diskless client.</para>
</listitem>
</varlistentry><varlistentry><term><option>n</option> <replaceable>client-name</replaceable></term><listitem><para>Specifies the name of the diskless client.</para>
</listitem>
</varlistentry><varlistentry><term><option>x os=</option><replaceable>instruction-set.machine-class.</replaceable>.Solaris_<replaceable>version</replaceable></term><listitem><para>Specifies the instruction architecture, machine class, OS,
and the Solaris version for the diskless client.</para>
</listitem>
</varlistentry><varlistentry><term><option>x root=</option><command>root=/export/root/</command><replaceable>client-name</replaceable></term><listitem><para>Identifies the root (<filename>/</filename>) directory for
the diskless client.</para>
</listitem>
</varlistentry><varlistentry><term><option>x swap=</option><command>root=/export/root/</command><replaceable>client-name</replaceable></term><listitem><para>Identifies the swap file for the diskless client.</para>
</listitem>
</varlistentry><varlistentry><term><option>x swapsize=</option><replaceable>size</replaceable></term><listitem><para>Specifies the size of the swap file in Mbytes. The default
is 24 Mbytes.</para>
</listitem>
</varlistentry><varlistentry><term><option>x tz=</option><replaceable>time-zone</replaceable></term><listitem><para>Specifies the time-zone for the diskless client.</para>
</listitem>
</varlistentry><varlistentry><term><option>x locale=</option><replaceable>locale-name</replaceable></term><listitem><para>Specifies the locale to install for the diskless client.</para>
</listitem>
</varlistentry>
</variablelist><para>For more information, see the <olink targetdoc="refman" targetptr="smdiskless-1m" remap="external"><citerefentry><refentrytitle>smdiskless</refentrytitle><manvolnum>1M</manvolnum></citerefentry></olink> man page.</para>
</step><step id="fxcib"><para>(Optional) Continue to use the <command>smdiskless
add</command> command to add each diskless client.</para>
</step><step id="fxcth"><para>Verify that the diskless clients were installed. </para><screen># <userinput>/usr/sadm/bin/smdiskless list -H <replaceable>host-name</replaceable>:898 --</userinput></screen>
</step>
</procedure><example arch="sparc"><title>Adding Diskless Client Support to a SPARC Based System</title><para>This example shows how to add Solaris 10 sun4u diskless client, <literal>starlite</literal>, from the server <literal>bearclaus</literal>.</para><screen width="100"># <userinput>/usr/sadm/bin/smdiskless add -- -i 172.20.27.28 -e 8:0:20:a6:d4:5b 
-n starlite -x os=sparc.sun4u.Solaris_10 -x root=/export/root/starlite 
-x swap=/export/swap/starlite -x swapsize=128 -x tz=US/Mountain 
-x locale=en_US</userinput>

# <userinput>/usr/sadm/bin/smdiskless list -H starlite:898 --</userinput>
Loading Tool: com.sun.admin.osservermgr.cli.OsServerMgrCli from line2-v480:898
Login to line2-v480 as user root was successful.
Download of com.sun.admin.osservermgr.cli.OsServerMgrCli from line2-v480:898 was 
successful.
Platform
--------------------------------------------------------------------------------
i386.i86pc.Solaris_10                                                           
sparc.sun4us.Solaris_10                                                         
sparc.sun4u.Solaris_10                                                          
i386.i86pc.Solaris_9                                                            
sparc.sun4m.Solaris_9                                                           
sparc.sun4u.Solaris_9                                                           
sparc.sun4us.Solaris_9</screen><para>Note that the <command>smdiskless list</command> <option>H</option> command
output lists both SPARC based and x86 based systems.</para>
</example><example id="fxcic" arch="x86"><title>Adding Diskless Client Support to an x86 Based System in the Solaris
10 OS</title><para>This example shows how to add a Solaris 10 x86 based diskless client, <literal>mars</literal>, from the server <literal>bearclaus</literal>.</para><screen># <userinput>/usr/sadm/bin/smdiskless add -- -i 172.20.27.176 -e 00:07:E9:23:56:48
-n mars -x os=i386.i86pc.Solaris_10 -x root=/export/root/mars 
-x swap=/export/swap/mars -x swapsize=128 -x tz=US/Mountain 
-x locale=en_US</userinput></screen>
</example>
</task><task id="fwazk" arch="x86"><title>How to Boot a Diskless Client With GRUB</title><tasksummary><para>If you have installed or upgraded your system to at least the Solaris
10 1/06 OS, the procedure for booting a diskless client has changed. Follow
these steps to boot a diskless client with GRUB.</para><note><para>Starting with the Solaris
Express 3/06 release, the GRUB failsafe interaction has changed. When booting
the failsafe archive, you are no longer prompted by the system to automatically
update the boot archives. The system prompts you to update the boot archives
only if inconsistent boot archives are detected. For more information, see <olink targetptr="fvznb" remap="internal">How to Boot the Failsafe Archive on an x86 Based System
by Using GRUB</olink>.</para>
</note>
</tasksummary><taskprerequisites><itemizedlist><para>To ensure that the system boots from the network, verify the following
prerequisites on the OS server:</para><listitem><para>Confirm that the name service used to add the diskless client
and the OS services matches the primary name in the server's <filename>/etc/nsswitch.conf</filename> file.</para>
</listitem><listitem><para>Verify that the DHCP and <command>tftp</command> boot services
are running.</para>
</listitem><listitem><para>Configure the system BIOS to boot the system from the network
by enabling the PXE ROM option.</para><para>Some PXE-capable network adapters
have a feature that enables PXE boot if you type a particular keystroke in
response to a brief boot-time prompt. See your hardware documentation for
information about how to set the boot priority in the BIOS.</para>
</listitem>
</itemizedlist>
</taskprerequisites><procedure><step><para>Boot the diskless client by typing the correct keystroke combination.</para><para>The GRUB menu is displayed.</para><para>Depending on the configuration of your network installation server,
the GRUB menu that is displayed on your system might vary from the GRUB menu
that is shown here.</para>
</step><step id="gcbdt"><para><indexterm id="gcbdn"><primary>run level</primary><secondary>3 (multiuser with NFS)</secondary><tertiary>booting to</tertiary></indexterm>Use the arrow keys to select a boot entry, then press Enter.</para><para>If you do not make a selection, the default OS instance is automatically
booted after several seconds.</para><stepalternatives><step><para>If you need to modify the GRUB kernel behavior by editing the
GRUB menu at boot time, use the arrow keys to select a boot entry, then type <command>e</command> to edit the entry. </para><note><para>The previous example shows the GRUB multiboot implementation.
The GRUB menus vary, depending on the Solaris release you are running.</para>
</note><para>The boot command that you want to edit is displayed in the GRUB edit
screen.</para><para>For more information about modifying kernel behavior at boot time, see <olink targetptr="grubtasks-1" remap="internal">Chapter&nbsp;11, Modifying Solaris Boot Behavior (Tasks)</olink>.</para>
</step><step><para>To save the edits and return to the GRUB menu, press Enter.</para><para>The GRUB menu is displayed, showing the edits you made to the boot command.</para>
</step><step><para>Type <command>b</command> to boot the system from the network.</para>
</step>
</stepalternatives>
</step>
</procedure>
</task><task id="clientsetup-5" arch="sparc"><title>How to Boot a Diskless Client
in the Solaris 10 OS</title><taskprerequisites><itemizedlist><para>Verify the following prerequisites on the OS server:</para><listitem><para>Confirm that the name service used to add the diskless client
and the OS services matches the primary name in the server's <filename>/etc/nsswitch.conf</filename> file.</para><para>Otherwise, the diskless client will not boot.</para>
</listitem><listitem><para>Confirm that the <command>rpc.bootparamd</command> daemon
is running. If it is not running, start it.</para>
</listitem>
</itemizedlist>
</taskprerequisites><procedure remap="single-step"><step id="clientsetup-step-1"><para><indexterm><primary>booting</primary><secondary>a diskless client (how to)</secondary></indexterm><indexterm><primary>diskless clients</primary><secondary>booting (how to)</secondary></indexterm>Boot the diskless client.</para><screen>ok <userinput>boot net</userinput></screen>
</step>
</procedure>
</task><task id="clientsetup-11"><title>How to Remove Diskless Client Support</title><procedure>&rolestep.sgm;<step id="clientsetup-step-18"><para>Remove the diskless client support.</para><screen># <userinput>/usr/sadm/bin/smdiskless delete -- -o <replaceable>host-name</replaceable>:898 -n</userinput> <replaceable>client-name</replaceable></screen>
</step><step id="clientsetup-step-20"><para>Verify that the diskless client support
has been removed. </para><screen># <userinput>/usr/sadm/bin/smosservice list -H <replaceable>host-name</replaceable>:898 --</userinput></screen>
</step>
</procedure><example><title>Removing Diskless Client Support</title><para>This example shows how to remove the diskless client <literal>holoship</literal> from
the OS server <literal>starlite</literal>.</para><screen># <userinput>/usr/sadm/bin/smdiskless delete -- -o starlite:898 -n holoship</userinput>
Authenticating as user: root

Type /? for help, pressing enter accepts the default denoted by [ ]
Please enter a string value for: password :: 
Starting SMC server version 2.0.0.
endpoint created: :898
SMC server is ready.

# <userinput>/usr/sadm/bin/smosservice list -H starlite:898 --</userinput>
Loading Tool: com.sun.admin.osservermgr.cli.OsServerMgrCli from starlite
Login to starlite as user root was successful.
Download of com.sun.admin.osservermgr.cli.OsServerMgrCli from starlite
was successful.</screen>
</example>
</task><task id="clientsetup-10"><title>How to Remove OS Services for Diskless Clients</title><procedure>&rolestep.sgm;<step id="clientsetup-step-3"><para><indexterm><primary>deleting</primary><secondary>diskless client OS services (how to)</secondary></indexterm><indexterm><primary>diskless clients</primary><secondary>deleting OS services (how to)</secondary></indexterm>Remove the OS services for the diskless clients.</para><screen># <userinput>/usr/sadm/bin/smosservice delete -H $HOST:$PORT -u root -p $PASSWD -- 
-x <replaceable>instruction-set</replaceable>.all.<replaceable>Solaris_version</replaceable></userinput></screen><note><para>Only the machine-class, <literal>all</literal>, is supported.</para>
</note>
</step><step id="clientsetup-step-5"><para>Verify that the OS services have been
removed.</para><screen># <userinput>/usr/sadm/bin/smosservice list -H <replaceable>host-name</replaceable>:898 --</userinput></screen>
</step>
</procedure><example><title>Removing OS Services for Diskless Clients</title><para><indexterm><primary>deleting</primary><secondary>diskless client OS services (example of)</secondary></indexterm><indexterm><primary>diskless clients</primary><secondary>deleting OS services (example of)</secondary></indexterm>The following example shows how to removing the diskless client
OS services (<literal>sparc.all.Solaris_10</literal>) from the server <literal>starlite</literal>.</para><screen># <userinput>/usr/sadm/bin/smosservice delete -H starlite:898 -u root
-p <replaceable>xxxxxx</replaceable> -- -x sparc.all.solaris_10</userinput>
Authenticating as user: root
Type /? for help, pressing enter accepts the default denoted by [ ]
Please enter a string value for: password :: 

# <userinput>/usr/sadm/bin/smosservice list -H starlite:898 --</userinput>
Loading Tool: com.sun.admin.osservermgr.cli.OsServerMgrCli from starlite:898
Login to starlite as user root was successful.
Download of com.sun.admin.osservermgr.cli.OsServerMgrCli from starlite:898
was successful</screen>
</example>
</task>
</sect1><sect1 id="clientsetup-13"><title>Patching Diskless Client OS Services</title><itemizedlist><para>You use the <command>smosservice patch</command> command to do the following:</para><listitem><para>Establish the <filename>/export/diskless/Patches</filename> patch
spool directory on an OS server.</para>
</listitem><listitem><para>Add patches to the patch spool directory. If the patch you
are adding obsoletes an existing patch in the spool, the obsolete patch is
moved to <filename>/export/diskless/Patches/Archive</filename>.</para>
</listitem><listitem><para>Delete patches from the patch spool directory.</para>
</listitem><listitem><para>List the patches in the patch spool directory.</para>
</listitem><listitem><para>Synchronize spooled patches out to clients. You must reboot
each synchronized client for the client to recognize the patch update.</para>
</listitem>
</itemizedlist><note><para>Keep your OS servers up to date by installing recommended OS patches
on a timely basis.</para>
</note><para>For information on downloading patches, see <olink targetptr="swmgrpatchtasks-7" remap="internal">How to Download and Apply a Solaris Patch</olink>.</para><sect2 id="clientsetup-12"><title>Displaying OS Patches for Diskless Clients</title><itemizedlist><para>Diskless client patches are logged in different directories, depending
on the type of patch:</para><listitem><para>Kernel patches are logged in the diskless client's <filename>/var/sadm/patch</filename> directory. To display kernel patches, type the following command
on the diskless client:</para><screen>% <userinput>patchadd &ndash;p</userinput></screen><note><para>You must be logged in to the diskless client when you run this
command. Running the <command>patchadd</command> <option>p</option> command
on the OS server displays kernel patches for the OS server only.</para>
</note>
</listitem><listitem><para><filename>/usr</filename> patches are logged in the OS server's <filename>/export/Solaris_<replaceable>version</replaceable>/var/patch</filename> directory.
A directory is created for each patch ID. To display <filename>/usr</filename> patches,
type the following command on the OS server:</para><screen>% <userinput>patchadd -S Solaris_<replaceable>version</replaceable> -p</userinput>
Patch: 111879-01 Obsoletes: Requires: Incompatibles: Packages: SUNWwsr</screen>
</listitem>
</itemizedlist><para>To list all spooled patches by OS and architecture, use the <command>smosservice</command> command with the <option>P</option> option.</para>
</sect2><task id="clientsetup-26"><title>How to Add an OS Patch for a Diskless Client</title><procedure>&rolestep.sgm;<step id="clientsetup-step-33"><para>Log in to the diskless client system
and shut it down.</para><screen># <userinput>init 0</userinput></screen>
</step><step id="clientsetup-step-28"><para>Add the patch to a spool directory.</para><screen># <userinput>/usr/sadm/bin/smosservice patch -- -a /var/patches/</userinput><replaceable>patch-ID-revision</replaceable></screen><para>If the patch to add depends on another patch, adding the patch fails
with the following message:</para><screen>The patch <replaceable>patch-ID-revision</replaceable> could not be added 
because it is dependent on other patches which have not yet been spooled. 
You must add all required patches to the spool first.</screen>
</step><step id="clientsetup-step-29"><para>Verify that the patch has been spooled.</para><screen># <userinput>/usr/sadm/bin/smosservice patch -- -P</userinput></screen>
</step><step id="clientsetup-step-30"><para>Push the spooled patch to the diskless
client.</para><screen># <userinput>/usr/sadm/bin/smosservice patch -- -m -U</userinput></screen><note><para>Pushing and synchronizing the patch to the diskless client can
take up to 90 minutes per patch.</para>
</note>
</step><step id="clientsetup-step-31"><para>Verify the patch is applied to the diskless
client.</para><screen># <userinput>/usr/sadm/bin/smosservice patch -- -P</userinput></screen>
</step>
</procedure><example><title>Adding an OS Patch for a Diskless Client</title><para>This example shows how to add a Solaris 8 patch (111879-01) to the diskless
client's OS services on the server.</para><screen># <userinput>/usr/sadm/bin/smosservice patch -- -a /var/patches/111879-01</userinput>
Authenticating as user: root

Type /? for help, pressing &lt;enter&gt; accepts the default denoted by [ ]
Please enter a string value for: password :: 
Loading Tool: com.sun.admin.osservermgr.cli.OsServerMgrCli from starlite
Login to starlite as user root was successful.
Download of com.sun.admin.osservermgr.cli.OsServerMgrCli from starlite 
was successful..
.
# <userinput>/usr/sadm/bin/smosservice patch -- -P</userinput>
Patches In Spool Area
Os Rel Arch   Patch Id  Synopsis
-------------------------------------------------------------------------
8      sparc  111879-01 SunOS 5.8: Solaris Product Registry patch SUNWwsr  

Patches Applied To OS Services
Os Service                              Patch
-------------------------------------------------------------------------
Solaris_8                               

Patches Applied To Clone Areas
Clone Area                              Patch
-------------------------------------------------------------------------
Solaris_8/sun4u          Patches In Spool Area
Os Rel Arch   Patch Id  Synopsis
----------------------------------------------------------------------------
8      sparc  111879-01 SunOS 5.8: Solaris Product Registry patch SUNWwsr   
.
.
.
# <userinput>/usr/sadm/bin/smosservice patch -- -m -U</userinput>
Authenticating as user: root

Type /? for help, pressing &lt;enter&gt; accepts the default denoted by [ ]
Please enter a string value for: password :: 
Loading Tool: com.sun.admin.osservermgr.cli.OsServerMgrCli from starlite
Login to starlite as user root was successful.
Download of com.sun.admin.osservermgr.cli.OsServerMgrCli from starlite 
was successful.

# <userinput>/usr/sadm/bin/smosservice patch -- -P</userinput>
Authenticating as user: root
.
.
.
Patches In Spool Area
Os Rel Arch   Patch Id  Synopsis
----------------------------------------------------------------------------
8      sparc  111879-01 SunOS 5.8: Solaris Product Registry patch SUNWwsr   

Patches Applied To OS Services
Os Service                              Patch
----------------------------------------------------------------------------
Solaris_8                               

Patches Applied To Clone Areas
Clone Area                              Patch
----------------------------------------------------------------------------
Solaris_8/sun4u</screen>
</example>
</task>
</sect1><sect1 id="gcezq"><title>Troubleshooting Diskless Client Problems</title><indexterm><primary>troubleshooting diskless client installation problems</primary><secondary>adding missing ARCH=all packages (how to)</secondary>
</indexterm><indexterm><primary>ARCH=all packages, how to add missing</primary><secondary>diskless client troubleshooting</secondary>
</indexterm><indexterm><primary>diskless client troubleshooting</primary><secondary>how to add missing ARCH=all packages</secondary>
</indexterm><para>This section describes problems that are encountered when managing diskless
clients and possible solutions.</para><sect2 id="gcfab"><title>Troubleshooting Diskless Client Installation Problems</title><para>The <command>smosservice add</command> command does not install any
packages that are designated <literal>ARCH=all</literal> in the root (<filename>/</filename>) or <filename>/usr</filename> file systems. As a result, these
packages are skipped. No warning or error messages are displayed. You must
add these packages to the newly-created Solaris OS service manually. This
behavior has existed since the Solaris 2.1 OS. The behavior applies to both
SPARC based and x86 based clients. Note that the list of missing packages
varies, depending on which Solaris OS you are running.</para><task id="archall-1"><title>How to Locate and Install Missing <literal>ARCH=all</literal> Packages</title><tasksummary><para>This procedure shows you how to locate and install missing <literal>ARCH=all</literal> packages after you have created the Solaris OS service on the server.
Examples that are provided in this procedure apply to the Solaris 10 6/06
OS.</para>
</tasksummary><procedure><step><para>Locate all the packages with the <literal>ARCH=all</literal> parameter.</para><substeps><step><para>Change directories to the <filename>Product</filename> directory
of the media for the Solaris 10 image. For example:</para><screen>% <userinput>cd /net/server/export/Solaris/s10u2/combined.s10s_u2wos/latest/Solaris_10/Product</userinput></screen>
</step><step><para>List all the packages in the <filename>pkginfo</filename> file
that have the <literal>ARCH=all</literal> parameter.</para><screen>% <userinput>grep -w ARCH=all */pkginfo</userinput></screen><para>If an error message indicating the arguments list is too long is displayed,
you can alternately run the following command to generate the list:</para><screen>% <userinput>find . -name pkginfo -exec grep -w ARCH=all {} /dev/null \;</userinput></screen><para>Note that running this command takes longer to produce results.</para><para>The output is similar to the following:</para><programlisting>./SUNWjdmk-base/pkginfo:ARCH=all
./SUNWjhdev/pkginfo:ARCH=all
./SUNWjhrt/pkginfo:ARCH=all
./SUNWjhdem/pkginfo:ARCH=all
./SUNWjhdoc/pkginfo:ARCH=all
./SUNWmlibk/pkginfo:ARCH=all</programlisting><para>The information that is provided in this list enables you to determine
which packages are installed in the <filename>/usr</filename> file system
and which packages are installed in the root (<filename>/</filename>) file
system.</para>
</step><step><para>Check the value of the <literal>SUNW_PKGTYPE</literal> parameter
in the package list you generated.</para><para>Packages that belong in the <filename>/usr</filename> file system are designated as <literal>SUNW_PKGTYPE=usr</literal> in
the <filename>pkginfo</filename> file. Packages that belong in the root (<filename>/</filename>) file system are designated as <literal>SUNW_PKGTYPE=root</literal> in
the <filename>pkginfo</filename> file. In the preceding output, all the packages
belong in the <filename>/usr</filename> file system.</para>
</step>
</substeps>
</step><step><para>Become superuser or assume an equivalent role.</para><para>Roles
contain authorizations and privileged commands. For more information about
roles, see <olink targetdoc="sysadv6" targetptr="rbactask-15" remap="external"><citetitle remap="section">Configuring RBAC (Task Map)</citetitle> in <citetitle remap="book">System Administration Guide: Security Services</citetitle></olink>.</para>
</step><step><para>Create the temporary installation administration files.</para><para>You
must create a separate installation administration file for packages that
are installed in the root (<filename>/</filename>) file system and a separate
installation administration file for packages that are installed in the <filename>/usr</filename> file system.</para><itemizedlist><listitem><para>For <literal>ARCH=all</literal> packages that are installed
in the <filename>/usr</filename> file system, create the following  temporary
installation administration file:</para><screen># cat &gt;/tmp/admin_usr &lt;&lt;EOF
mail=
instance=unique
partial=nocheck
runlevel=nocheck
idepend=nocheck
rdepend=nocheck
space=nocheck
setuid=nocheck
conflict=nocheck
action=nocheck
basedir=/usr_sparc.all
EOF
#</screen>
</listitem><listitem><para>For <filename>ARCH=all</filename> packages that are installed
in the root (<filename>/)</filename> file system, if any exist, create the
following  temporary installation administration file:</para><screen># cat &gt;/tmp/admin_root &lt;&lt;EOF
mail=
instance=unique
partial=nocheck
runlevel=nocheck
idepend=nocheck
rdepend=nocheck
space=nocheck
setuid=nocheck
conflict=nocheck
action=nocheck
EOF
#</screen>
</listitem>
</itemizedlist>
</step><step><para>Install the missing <literal>ARCH=all</literal> packages.</para><substeps><step><para>If the current directory is not the Product directory of the media
for the Solaris 10 image, change directories to that directory. For example:</para><screen># <userinput>cd /net/<replaceable>server</replaceable>/export/Solaris/s10u2/combined.s10s_u2wos/latest/Solaris_10/Product</userinput></screen><para>You can run the <command>pwd</command> command to determine the current
directory.</para>
</step><step><para>Install the missing <literal>ARCH=all</literal> packages in the <filename>/usr</filename> file system.</para><screen width="100"># <userinput>pkgadd -R /export/Solaris_10 -a /tmp/admin_usr -d `pwd` [<replaceable>package-A</replaceable> <replaceable>package-B</replaceable> ...]</userinput></screen><para>Multiple packages can be listed when you running the <command>pkgadd</command> command.</para>
</step><step><para>Check that the <literal>ARCH=all</literal> packages were installed.</para><screen># <userinput>pkginfo  -R /export/Solaris_10  [<replaceable>package-A</replaceable> <replaceable>package-B</replaceable> ...]</userinput></screen>
</step><step><para>Install the missing <literal>ARCH=all</literal> packages that
in the root (<filename>/</filename>) file system.</para><para>Note that it
is possible that none of these packages exist.</para><screen># <userinput>pkgadd  -R /export/root/clone/Solaris_10/sun4u  -a /tmp/admin_root -d `pwd`  [<replaceable>package-X</replaceable> <replaceable>package-Y</replaceable> ...]</userinput></screen>
</step><step><para>Check that the <literal>ARCH=all</literal> packages were installed.</para><screen># <userinput>pkginfo  -R /export/root/clone/Solaris_10/sun4u [<replaceable>package-X</replaceable> <replaceable>package-</replaceable> ...]</userinput></screen>
</step>
</substeps>
</step><step><para>After you have finished adding the missing <literal>ARCH=all</literal> packages,
remove the temporary installation administration file.</para><screen># <userinput>rm /tmp/<replaceable>administration-file</replaceable></userinput></screen>
</step>
</procedure><example id="gcfgn"><title>Locating and Installing Missing <literal>ARCH=all</literal>Packages</title><indexterm><primary>adding missing ARCH=all packages (example of)</primary>
</indexterm><para>This example shows how to install the missing <literal>ARCH=all</literal> package, <literal>SUNWjdmk-base</literal>, in the <filename>/usr</filename> file system.</para><screen width="100">% <userinput>uname -a</userinput>
SunOS t1fac46 5.10 Generic_118833-02 sun4u sparc SUNW,UltraSPARC-IIi-cEngine

% <userinput>cat /etc/release</userinput>
                       Solaris 10 6/06 s10s_u2wos_03 SPARC
           Copyright 2006 Sun Microsystems, Inc.  All Rights Reserved.
                        Use is subject to license terms.
                           Assembled 06 February 2006

% <userinput>cd /net/ventor/export/Solaris/s10u2/combined.s10s_u2wos/latest/Solaris_10/Product</userinput>

% <userinput>grep -w ARCH=all */pkginfo</userinput>
Arguments too long

% <userinput>find . -name pkginfo -exec grep -w ARCH=all {} /dev/null \;</userinput>
./SUNWjdmk-base/pkginfo:ARCH=all
./SUNWjhdev/pkginfo:ARCH=all
./SUNWjhrt/pkginfo:ARCH=all
./SUNWjhdem/pkginfo:ARCH=all
./SUNWjhdoc/pkginfo:ARCH=all
./SUNWmlibk/pkginfo:ARCH=all

% <userinput>grep -w SUNW_PKGTYPE=usr ./SUNWjdmk-base/pkginfo ./SUNWjhdev/pkginfo ...</userinput>
./SUNWjdmk-base/pkginfo:SUNW_PKGTYPE=usr
./SUNWjhdev/pkginfo:SUNW_PKGTYPE=usr
./SUNWjhrt/pkginfo:SUNW_PKGTYPE=usr
./SUNWjhdem/pkginfo:SUNW_PKGTYPE=usr
./SUNWjhdoc/pkginfo:SUNW_PKGTYPE=usr

% <userinput>grep -w SUNW_PKGTYPE=root ./SUNWjdmk-base/pkginfo ./SUNWjhdev/pkginfo ...</userinput>

% <userinput>su</userinput>
Password: <userinput>xxxxxx

# cat &gt;/tmp/admin_usr &lt;&lt;EOF
mail=
instance=unique
partial=nocheck
runlevel=nocheck
idepend=nochec&gt; k
rdepend=nocheck
space=nocheck
setuid=nocheck
conflict=nocheck
action=nocheck
basedir=/usr_sparc.all
EOF</userinput>

# <userinput>pwd</userinput>
/net/ventor/export/Solaris/s10u2/combined.s10s_u2wos/latest/Solaris_10/Product

# <userinput>pkginfo  -R /export/Solaris_10  SUNWjdmk-base</userinput> 
ERROR: information for "SUNWjdmk-base" was not found

# <userinput>pkgadd  -R /export/Solaris_10  -a /tmp/admin_usr  -d `pwd`  SUNWjdmk-base</userinput>

Processing package instance &lt;SUNWjdmk-base&gt; &lt;/net/ventor/export/Solaris/s10u2/combined.s10s_u2wos...


Java DMK 5.1 minimal subset(all) 5.1,REV=34.20060120
Copyright 2005 Sun Microsystems, Inc.  All rights reserved.
Use is subject to license terms.
Using &lt;/export/Solaris_10/usr_sparc.all&gt;
## Processing package information.
## Processing system information.

Installing Java DMK 5.1 minimal subset as &lt;SUNWjdmk-base&gt;

## Installing part 1 of 1.
2438 blocks

Installation of &lt;SUNWjdmk-base&gt; was successful.

# <userinput>pkginfo -R /export/Solaris_10 SUNWjdmk-base</userinput>
application SUNWjdmk-base Java DMK 5.1 minimal subset

# <userinput>rm /tmp/admin_usr</userinput></screen>
</example>
</task>
</sect2><sect2 id="clientsetup-16"><title>Troubleshooting General Diskless Client
Problems</title><para><indexterm><primary>troubleshooting</primary><secondary>diskless client general problems</secondary></indexterm>This section lists some common problems
with diskless clients that you might encounter and possible solutions.</para><qandaset defaultlabel="troubleshooting"><qandaentry><question><para>Diskless client reports <literal>Owner of the module /usr/lib/security/pam_unix_session.so.1
is not root</literal>, when attempting to log in, the <filename>/usr</filename> file
system is owned by <literal>nobody</literal>.</para>
</question><answer><para>To correct the problem, follow this workaround:</para><orderedlist><listitem><para>Using a text editor, modify the diskless client's <filename>server:/export/root/client/etc/default/nfs</filename> file.</para>
</listitem><listitem><para>Change the <literal>#NFSMAPID_DOMAIN=domain</literal> line
to the following:</para><screen>NFSMAPID_DOMAIN=the_same_value_as_in_server's_/var/run/nfs4_domain</screen>
</listitem><listitem><para>Ensure that the OS server and the diskless client have the
same <literal>nfsmapid</literal> domain. To verify this information, check
the <filename>/var/run/nfs4_domain</filename> file.</para><caution><para>If the diskless client's <filename>nfs4_domain</filename> file
contains a different value than the OS server's <filename>/var/run/nfs4_domain</filename> file,
you will not be able to log in to the system after the diskless client boots.</para>
</caution>
</listitem><listitem><para>Reboot the diskless client.</para>
</listitem>
</orderedlist><para>For more information, see <olink targetdoc="soltuneparamref" targetptr="chapter3-1" remap="external">Chapter 3, <citetitle remap="chapter">NFS Tunable Parameters,</citetitle> in <citetitle remap="book">Solaris Tunable Parameters Reference Manual</citetitle></olink> and <olink targetdoc="refman" targetptr="nfsmapid-1m" remap="external"><citerefentry><refentrytitle>nfsmapid</refentrytitle><manvolnum>1M</manvolnum></citerefentry></olink>.</para>
</answer>
</qandaentry>
</qandaset><qandaset defaultlabel="troubleshooting"><qandaentry><question><para>The OS server fails to do the following:</para><itemizedlist><listitem><para>Respond to client Reverse Address Resolution Protocol (RARP)
requests</para>
</listitem><listitem><para>Respond to client <command>bootparam</command> requests</para>
</listitem><listitem><para>Mount a diskless client root (<filename>/</filename>) file
system</para>
</listitem>
</itemizedlist>
</question><answer><para>The following solutions apply in a files environment.</para><itemizedlist><listitem><para>Verify that <filename>files</filename> is listed as the first
source for <filename>hosts</filename>, <filename>ethers</filename>, and <filename>bootparams</filename> in the <filename>/etc/nsswitch.conf</filename> file
on the OS server.</para>
</listitem><listitem><para>Verify that the client's IP address appears in the <filename>/etc/inet/hosts</filename> file. </para><note><para>If you are <emphasis>not</emphasis> running at least the Solaris
10 8/07 release, you must also verify that the client's IP address appears
in the <filename>/etc/inet/ipnodes</filename> file.</para><para>In this Solaris
release, there is no longer two separate <filename>hosts</filename> files.
The <filename>/etc/inet/hosts</filename> file is a single file that contains
both IPv4 and IPv6 entries. You do not need to maintain IPv4 entries in two <filename>hosts</filename> files that always require synchronization. For backward compatibility,
the <filename>/etc/inet/ipnodes</filename> file is replaced with a symbolic
link of the same name to the <filename>/etc/inet/hosts</filename> file.  For
more information, see the <olink targetdoc="group-refman" targetptr="hosts-4" remap="external"><citerefentry><refentrytitle>hosts</refentrytitle><manvolnum>4</manvolnum></citerefentry></olink> man
page.</para>
</note>
</listitem><listitem><para>Verify that the client's Ethernet address appears in the <filename>/etc/ethers</filename> file.</para>
</listitem><listitem><para>Verify that the <filename>/etc/bootparams</filename> file
contains the following paths to the client's root (<filename>/</filename>)
directory and swap areas.</para><screen><replaceable>client</replaceable> root=<replaceable>os-server</replaceable>:/export/root/<replaceable>client</replaceable> swap=<replaceable>os-server</replaceable>:
/export/swap/<replaceable>client</replaceable> </screen><para>The swap size varies depending on whether you specify the <option>x</option> <replaceable>swapsize</replaceable> option when you add the diskless client. If you specify
the <option>x</option> <replaceable>dump</replaceable> option when you add
the diskless client, the following line is present.</para><screen>dump=<replaceable>os-server</replaceable>:/export/dump/<replaceable>client</replaceable> dumpsize=512</screen><para>The dump size varies depending on whether you specify the <option>x</option> <replaceable>dumpsize</replaceable> option when you add the diskless client.</para>
</listitem><listitem><para>Verify that the OS server's IP address appears in the <filename>/export/root/<replaceable>client</replaceable>/etc/inet/hosts</filename> file.</para>
</listitem>
</itemizedlist>
</answer>
</qandaentry>
</qandaset><qandaset defaultlabel="troubleshooting"><qandaentry><question><para>The OS server fails to do the following:</para><itemizedlist><listitem><para>Respond to client RARP requests</para>
</listitem><listitem><para>Respond to client <command>bootparam</command> requests</para>
</listitem><listitem><para>Mount a diskless client root (<filename>/</filename>) file
system</para>
</listitem>
</itemizedlist>
</question><answer><para>The following solutions apply in a name service environment.</para><itemizedlist><listitem><para>Verify that both the OS server's and the client's Ethernet
address and IP address are correctly mapped. </para>
</listitem><listitem><para>Verify that the <filename>/etc/bootparams</filename> file
contains the paths to the client's root (<filename>/</filename>) directory
and swap areas.</para><screen width="70"><replaceable>client</replaceable> root=<replaceable>os-server</replaceable>:/export/
root/<replaceable>client</replaceable> swap=<replaceable>os-server</replaceable>:/export/
swap/<replaceable>client</replaceable> swapsize=24</screen><para>The swap size varies depending on whether you specify the <option>x</option> <replaceable>swapsize</replaceable> option when you add the diskless client. If you specify
the <option>x</option> <replaceable>dump</replaceable> option when you add
the diskless client, the following line is present:</para><screen width="70">dump=<replaceable>os-server</replaceable>:/export/dump/<replaceable>client</replaceable> dumpsize=24</screen><para>The dump size varies depending on whether you specify the <option>x</option> <replaceable>dumpsize</replaceable> option when you add the diskless client.</para>
</listitem>
</itemizedlist>
</answer>
</qandaentry>
</qandaset><qandaset defaultlabel="troubleshooting"><qandaentry><question><para>Diskless client panics</para>
</question><answer><para>Verify the following:</para><itemizedlist><listitem><para>The OS server's Ethernet address is correctly mapped to its
IP address. If you physically moved a system from one network to another,
you might have forgotten to remap the system's new IP address.</para>
</listitem><listitem><para>The client's host name, IP address, and Ethernet address do
not exist in the database of another server <emphasis>on the same subnet</emphasis> that
responds to the client's RARP, Trivial File Transfer Protocol (TFTP), or <filename>bootparam</filename> requests. Often, test systems are set up to install their
OS from an install server. In these cases, the install server answers the
client's RARP or <filename>bootparam</filename> request, returning an incorrect
IP address. This incorrect address might result in the download of a boot
program for the wrong architecture, or a failure to mount the client's root
(<filename>/</filename>) file system.</para>
</listitem><listitem><para>The diskless client's TFTP requests are not answered by an
install server (or previous OS server) that transfers an incorrect boot program.
If the boot program is of a different architecture, the client immediately
panics. If the boot program loads from a non-OS server, the client might obtain
its root partition from the non-OS server and its <filename>/usr</filename> partition
from the OS server. In this situation, the client panics if the root and <filename>/usr</filename> partitions are of conflicting architectures or versions. </para>
</listitem><listitem><para>If you are using both an install server and an OS server,
verify that the following entry exists in the <filename>/etc/dfs/dfstab</filename> file.</para><screen>share <option>F</option> nfs <option>o</option> <option>ro</option> <filename>/export/exec/Solaris_<replaceable>version</replaceable>-<replaceable>instruction-set</replaceable>.all/usr</filename></screen><para>where <replaceable>version</replaceable>= <literal>8</literal>, <literal>9</literal>,<literal>10</literal>, 11, and <replaceable>instruction-set</replaceable>=<literal>sparc</literal> or <literal>i386</literal>.</para>
</listitem><listitem><para>Verify that the diskless client's root (<filename>/</filename>), <filename>/swap</filename>, and <filename>/dump</filename> (if specified) partitions
have share entries:  </para><screen>share -F nfs -o rw=<replaceable>client</replaceable>,root=<replaceable>client</replaceable> /export/root/<replaceable>client</replaceable> 
share -F nfs -o rw=<replaceable>client</replaceable>,root=<replaceable>client</replaceable> /export/swap/<replaceable>client</replaceable> 
share -F nfs -o rw=<replaceable>client</replaceable>,root=<replaceable>client</replaceable> /export/dump/<replaceable>client</replaceable></screen>
</listitem><listitem><para>On the OS server, type the following command to check which
files are shared:</para><screen>% <userinput>share</userinput></screen><para>The OS server must share <filename>/export/root/</filename><replaceable>client</replaceable> and <filename>/export/swap/</filename><replaceable>client-name</replaceable> (defaults),
or the root, <filename>/swap</filename>, and <filename>/dump</filename> partitions
that you specified when you added the diskless client.</para><para>Verify that the following entries exist in the <filename>/etc/dfs/dfstab</filename> file:</para><screen>share -F nfs -o ro /export/exec/Solaris_<replaceable>version</replaceable>-<replaceable>instruction-set</replaceable>.all/usr
share -F nfs -o rw=<replaceable>client</replaceable>,root=<replaceable>client</replaceable> /export/root/<replaceable>client</replaceable>
share -F nfs -o rw=<replaceable>client</replaceable>,root=<replaceable>client</replaceable> /export/swap/<replaceable>client</replaceable></screen>
</listitem>
</itemizedlist>
</answer>
</qandaentry>
</qandaset><qandaset defaultlabel="troubleshooting"><qandaentry><question><para>OS server is not responding to diskless client's RARP request</para>
</question><answer><para>From the client's intended OS server, run the <command>snoop</command> command
as superuser (<literal>root</literal>) by using the client's Ethernet address:</para><screen># <userinput>snoop xx:xx:xx:xx:xx:xx</userinput></screen>
</answer>
</qandaentry>
</qandaset><qandaset defaultlabel="troubleshooting"><qandaentry><question><para>Boot program downloads but panics early in the process</para>
</question><answer><para>Use the <command>snoop</command> command to verify that the
intended OS server is answering the client's TFTP and NFS requests.</para>
</answer>
</qandaentry>
</qandaset><qandaset defaultlabel="troubleshooting"><qandaentry><question><para>Diskless client hangs.</para>
</question><answer><para>Restart the following daemons on the OS server:</para><screen># <userinput>/usr/sbin/rpc.bootparamd</userinput>
# <userinput>/usr/sbin/in.rarpd -a</userinput></screen>
</answer>
</qandaentry>
</qandaset><qandaset defaultlabel="troubleshooting"><qandaentry><question><para>Incorrect server responds to diskless client's RARP request</para>
</question><answer><para>Restart the following daemons on the OS server:</para><screen># <userinput>/usr/sbin/rpc.bootparamd</userinput>
# <userinput>svcadm enable network/rarp</userinput></screen>
</answer>
</qandaentry>
</qandaset>
</sect2>
</sect1>
</chapter><?Pub *0000088769 0?>