<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Repairing an Unbootable System - Solaris ZFS Administration Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-01-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">Solaris ZFS Administration Guide</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="gbbwl.html">Previous</a>
             </td>
             <td align="right">
                 <a href="idx-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="zfsover-1.html">1.&nbsp;&nbsp;Solaris ZFS File System (Introduction)</a></p>
<p class="toc level1 tocsp"><a href="setup-1.html">2.&nbsp;&nbsp;Getting Started With ZFS</a></p>
<p class="toc level1 tocsp"><a href="gbcik.html">3.&nbsp;&nbsp;ZFS and Traditional File System Differences</a></p>
<p class="toc level1 tocsp"><a href="gavwn.html">4.&nbsp;&nbsp;Managing ZFS Storage Pools</a></p>
<p class="toc level1 tocsp"><a href="gavwq.html">5.&nbsp;&nbsp;Managing ZFS File Systems</a></p>
<p class="toc level1 tocsp"><a href="gavvx.html">6.&nbsp;&nbsp;Working With ZFS Snapshots and Clones</a></p>
<p class="toc level1 tocsp"><a href="ftyxi.html">7.&nbsp;&nbsp;Using ACLs to Protect ZFS Files</a></p>
<p class="toc level1 tocsp"><a href="gbchv.html">8.&nbsp;&nbsp;ZFS Delegated Administration</a></p>
<p class="toc level1 tocsp"><a href="ftyxh.html">9.&nbsp;&nbsp;ZFS Advanced Topics</a></p>
<p class="toc level1 tocsp"><a href="gavwg.html">10.&nbsp;&nbsp;ZFS Troubleshooting and Data Recovery</a></p>
<p class="toc level2"><a href="gbbth.html">ZFS Failure Modes</a></p>
<p class="toc level2"><a href="gbbwa.html">Checking ZFS Data Integrity</a></p>
<p class="toc level2"><a href="gbbuw.html">Identifying Problems in ZFS</a></p>
<p class="toc level2"><a href="gbbve.html">Repairing a Damaged ZFS Configuration</a></p>
<p class="toc level2"><a href="gbbvb.html">Repairing a Missing Device</a></p>
<p class="toc level2"><a href="gbbvf.html">Repairing a Damaged Device</a></p>
<p class="toc level2"><a href="gbbwl.html">Repairing Damaged Data</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Repairing an Unbootable System</a></p>
</div>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="gbbwc"></a><h3>Repairing an Unbootable System</h3>
<p>ZFS is designed to be robust and stable despite errors. Even so,
software bugs or certain unexpected pathologies might cause the system to panic when a
pool is accessed. As part of the boot process, each pool must
be opened, which means that such failures will cause a system to enter
into a panic-reboot loop. In order to recover from this situation, ZFS must
be informed not to look for any pools on startup.<a name="indexterm-660"></a><a name="indexterm-661"></a><a name="indexterm-662"></a></p><p>ZFS maintains an internal cache of available pools and their configurations in <tt>/etc/zfs/zpool.cache</tt>.
The location and contents of this file are private and are subject to
change. If the system becomes unbootable, boot to the <tt>none</tt> milestone by using
the <tt>-m milestone=none</tt> boot option. Once the system is up, remount your root
file system as writable and then remove <tt>/etc/zfs/zpool.cache</tt>. These actions cause ZFS to forget
that any pools exist on the system, preventing it from trying to access
the bad pool causing the problem. You can then proceed to a normal
system state by issuing the <tt>svcadm milestone all</tt> command. You can use a similar process
when booting from an alternate root to perform repairs.</p><p>Once the system is up, you can attempt to import the pool
by using the <tt>zpool import</tt> command. However, doing so will likely cause the
same error that occurred during boot, because the command uses the same mechanism to
access pools. If more than one pool is on the system and
you want to import a specific pool without accessing any other pools, you
must re-initialize the devices  in the damaged pool, at which point you can
safely import the good pool.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="gbbwl.html">Previous</a>
             </td>
             <td align="right">
                 <a href="idx-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

